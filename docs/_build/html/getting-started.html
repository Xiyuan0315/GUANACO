

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GUANACO Interface &mdash; GUANACO  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Instruction for Using GUANACO" href="deployment/index.html" />
    <link rel="prev" title="GUANACO User Guide" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GUANACO
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">GUANACO Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#anndata-visualization">Anndata Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-overview">Data Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#marker-genes-visualization">Marker Genes Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#heatmap">Heatmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#violin-plot">Violin Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dot-plot">Dot Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stacked-bar-plot">Stacked Bar Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pseudotime-plot">Pseudotime Plot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#subset-exploration">Subset Exploration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cell-selection">Cell Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#export-selected-subgroup">Export Selected Subgroup</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#genome-track-visualization">Genome Track Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#igv-browser-and-motif-dataset">IGV Browser and Motif Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployment/index.html">Instruction for Using GUANACO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deployment/installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment/installation.html#install-from-source">Install from Source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment/installation.html#step-1-clone-the-repository">Step 1. Clone the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/installation.html#step-2-set-up-a-python-environment">Step 2. Set up a Python environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/installation.html#step-3-install-guanaco">Step 3. Install GUANACO</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/installation.html#step-4-run-guanaco">Step 4. Run GUANACO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment/installation.html#install-with-docker">Install with Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment/installation.html#step-1-install-docker">Step 1. Install Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/installation.html#step-2-run-docker-image">Step 2. Run Docker Image</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deployment/configuring-json.html">Configuring Json File</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment/running-python.html">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment/running-python.html#deployment-with-system-python">Deployment with System Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment/running-python.html#step-1-clone-the-repository">Step 1. Clone the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/running-python.html#step-2-create-a-virtual-environment">Step 2. Create a virtual environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/running-python.html#step-3-install-guanaco">Step 3. Install GUANACO</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/running-python.html#step-4-run-guanaco">Step 4. Run GUANACO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment/running-python.html#deployment-with-docker">Deployment with Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment/running-python.html#step-1-install-docker">Step 1. Install Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment/running-python.html#step-2-run-docker-image">Step 2. Run Docker image</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GUANACO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">GUANACO Interface</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/getting-started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="guanaco-interface">
<h1>GUANACO Interface<a class="headerlink" href="#guanaco-interface" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#anndata-visualization" id="id1">Anndata Visualization</a></p>
<ul>
<li><p><a class="reference internal" href="#data-overview" id="id2">Data Overview</a></p></li>
<li><p><a class="reference internal" href="#marker-genes-visualization" id="id3">Marker Genes Visualization</a></p></li>
<li><p><a class="reference internal" href="#subset-exploration" id="id4">Subset Exploration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#genome-track-visualization" id="id5">Genome Track Visualization</a></p>
<ul>
<li><p><a class="reference internal" href="#igv-browser-and-motif-dataset" id="id6">IGV Browser and Motif Dataset</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="anndata-visualization">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Anndata Visualization</a><a class="headerlink" href="#anndata-visualization" title="Link to this heading"></a></h2>
<section id="data-overview">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Data Overview</a><a class="headerlink" href="#data-overview" title="Link to this heading"></a></h3>
<p>When the interface is opened, the default displays the <strong>Description</strong> panel and a <strong>side-by-side dimensional reduction view</strong>. Each embedding can be colored by metadata
or by gene expression (selected from the
dropdown). The image below highlights how to quickly explore the dataset
to capture most of the key information.</p>
<a class="reference internal image-reference" href="_images/interface1.png"><img alt="_images/interface1.png" src="_images/interface1.png" style="width: 1000px;" />
</a>
<p><strong>Data Selection:</strong>
Use the <em>Global Data Filter</em> to select or deselect cells displayed in
the embedding by categorical metadata. All embeddings stored in <cite>.obsm</cite> will be available in the
<em>Dimensional Reduction</em> panel. For dimensional reduction methods with
more than two axes, you may select at most two for display (<cite>X-axis</cite>
and <cite>Y-axis</cite>).</p>
<p><strong>Navigation and Tools:</strong></p>
<p><strong>Zooming</strong>: Use the scroll wheel to zoom in and out. The two embeddings are linked, ensuring synchronized navigation.</p>
<ul>
<li><p><strong>Toolbar icons (top-right):</strong>
- <em>Camera</em>: Download the current view as <cite>.svg</cite>.
- <em>Pan tool (middle icon):</em> Hold the space bar and drag to move the</p>
<blockquote>
<div><p>view; double-click to reset to default.</p>
</div></blockquote>
<ul class="simple">
<li><p><em>Lasso tool:</em> Select cells in the left embedding and pass them to
other plots (see <em>Cell Selection</em> section).</p></li>
</ul>
</li>
</ul>
</section>
<section id="marker-genes-visualization">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Marker Genes Visualization</a><a class="headerlink" href="#marker-genes-visualization" title="Link to this heading"></a></h3>
<section id="heatmap">
<h4>Heatmap<a class="headerlink" href="#heatmap" title="Link to this heading"></a></h4>
<p>GUANACO provides single-cell level heatmaps supporting up to <strong>50k
cells</strong>. The order of Cells (columns) and genes (rows) are controlled from the left
panel. If the dataset exceeds this limit, cells are automatically
binned. Three transformation options are available: <strong>none, log, and
z-score</strong>. For z-score, the top 99th percentile is used for better
visualization.</p>
<p>Heatmaps support up to <strong>two annotations</strong>; one may be continuous (e.g.,
pseudotime). By default, cells are clustered first by the primary
annotation and then by the secondary. If the secondary annotation is
continuous, ordering is prioritized by the continuous variable.</p>
<a class="reference internal image-reference" href="_images/heatmap.png"><img alt="_images/heatmap.png" src="_images/heatmap.png" style="width: 1000px;" />
</a>
<p><strong>Color settings:</strong>
- The discrete colormap for the first annotation matches the embedding
section.
- The colormap for the secondary annotation can be chosen via dropdown.
- A library of <strong>96 continuous colormaps</strong> is provided.</p>
<blockquote>
<div><ul class="simple">
<li><p>Sequential colormaps are recommended for raw and log data.</p></li>
<li><p>Diverging colormaps are recommended for z-score to highlight
differences.(see example below)</p></li>
</ul>
</div></blockquote>
<a class="reference internal image-reference" href="_images/z-score_heatmap.png"><img alt="_images/z-score_heatmap.png" src="_images/z-score_heatmap.png" style="width: 1000px;" />
</a>
</section>
<section id="violin-plot">
<h4>Violin Plot<a class="headerlink" href="#violin-plot" title="Link to this heading"></a></h4>
<p>GUANACO offers two violin plot types: <strong>stacked</strong> (for multiple markers)
and <strong>split/grouped</strong> (for group comparisons).</p>
<p><strong>Stacked violin plot</strong> is controlled by left panel options, same as heatmap and other plots in the tab.</p>
<a class="reference internal image-reference" href="_images/violin1.png"><img alt="_images/violin1.png" src="_images/violin1.png" style="width: 1000px;" />
</a>
<p>Colors are consistent with the embedding plots. Options include adding a
box plot inside the violin and/or scatter dots alongside. Note that
showing all scatter points may be slow for large datasets or multiple
genes.</p>
<p><strong>Split/grouped violin plots</strong> is a separated section that has its own gene, metadata selection panel. It allows clear group comparisons. Four
analysis modes are supported:</p>
<ul class="simple">
<li><p><strong>Mode 1:</strong> Single metadata grouping
- Two groups → Mann–Whitney U test and t-test
- More than two groups → Kruskal–Wallis (KW) test and ANOVA</p></li>
<li><p><strong>Mode 2:</strong> Facet by first metadata, compare second metadata
- Two groups → Mann–Whitney U test and t-test (split violin view)
- More than two groups → KW test and ANOVA (grouped violin view)</p></li>
<li><p><strong>Mode 3:</strong> Linear model
- Adjusts for a confounder: <cite>expression ~ obs1 + obs2</cite>
- Useful for non-nested metadata (e.g., treatment and gender)</p></li>
<li><p><strong>Mode 4:</strong> Mixed model
- Treats obs2 as a random effect: <cite>expression ~ meta1 + (1|obs2)</cite>
- Suitable for hierarchical structures (e.g., patient nested withincondition)</p></li>
</ul>
<p><strong>Example Mode 2:</strong></p>
<p>Question: For each cell type, is there a difference in expression
between conditions?</p>
<a class="reference internal image-reference" href="_images/violin2.png"><img alt="_images/violin2.png" src="_images/violin2.png" style="width: 1000px;" />
</a>
<p><strong>Example Mode 3:</strong></p>
<p>Question: Which metadata contributes more to group differences?</p>
<a class="reference internal image-reference" href="_images/violin2_mode3.png"><img alt="_images/violin2_mode3.png" src="_images/violin2_mode3.png" style="width: 1000px;" />
</a>
</section>
<section id="dot-plot">
<h4>Dot Plot<a class="headerlink" href="#dot-plot" title="Link to this heading"></a></h4>
<p>Dot plots summarize <strong>aggregated expression</strong> across groups and are
useful for displaying marker gene expression. GUANACO provides two plot
types:</p>
<ul class="simple">
<li><p><strong>Dot plot</strong></p></li>
<li><p><strong>Matrix plot (pseudo-bulk heatmap)</strong></p></li>
</ul>
<a class="reference internal image-reference" href="_images/dotplot.png"><img alt="_images/dotplot.png" src="_images/dotplot.png" style="width: 1000px;" />
</a>
<p><strong>Standardization</strong> (0–1 scaling) is available to make genes directly
comparable across plots.</p>
</section>
<section id="stacked-bar-plot">
<h4>Stacked Bar Plot<a class="headerlink" href="#stacked-bar-plot" title="Link to this heading"></a></h4>
<p>Stacked bar plots illustrate <strong>cell composition</strong> across groups.
Annotation and labels on the left determine stacked layers, while
selection within the stacked bar tab defines the x-axis. Users can
display <strong>proportions</strong> or <strong>absolute counts</strong>. Hovering reveals more
details. Groups can be reordered by dragging column headers.</p>
<a class="reference internal image-reference" href="_images/bar.png"><img alt="_images/bar.png" src="_images/bar.png" style="width: 1000px;" />
</a>
</section>
<section id="pseudotime-plot">
<h4>Pseudotime Plot<a class="headerlink" href="#pseudotime-plot" title="Link to this heading"></a></h4>
<p>The Pseudotime Plot visualizes <strong>gene expression dynamics along a
trajectory</strong> (or other continuous metadata). A generalized linear model
(GLM) smooth line is fitted to highlight trends.</p>
<a class="reference internal image-reference" href="_images/pseudotime.png"><img alt="_images/pseudotime.png" src="_images/pseudotime.png" style="width: 1000px;" />
</a>
<p><strong>Key Features</strong>
- Displays gene expression changes along pseudotime
- Supports multiple genes in stacked subplots
- Fits smoothed regression curves to highlight patterns
- Colors points by grouping variable (e.g., cell type or cluster)</p>
<p><strong>Interactive Controls</strong>
- Filter by minimum expression threshold
- Transformation: None, Log, Z-score
- Select pseudotime column if multiple are available</p>
<p><strong>Use Cases</strong>
- Identify genes switching on/off during differentiation
- Detect transitional cell state markers
- Validate computational trajectory inference
- Explore temporal gene regulation</p>
</section>
</section>
<section id="subset-exploration">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Subset Exploration</a><a class="headerlink" href="#subset-exploration" title="Link to this heading"></a></h3>
<section id="cell-selection">
<h4>Cell Selection<a class="headerlink" href="#cell-selection" title="Link to this heading"></a></h4>
<p>Beyond visualization, GUANACO provides flexible tools for interactively selecting subsets of cells, enabling focused downstream analyses.</p>
<a class="reference internal image-reference" href="_images/selection.png"><img alt="_images/selection.png" src="_images/selection.png" style="width: 1000px;" />
</a>
<p>Cell selection operates on <strong>two layers</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Global Data Filter (categorical metadata)</strong>
- Controls which cells are displayed in embeddings
- Access via <em>Show Filters</em> panel
- Select or clear metadata values, then apply</p></li>
<li><p><strong>Lasso Selection (embedding plots)</strong>
- Select cells interactively with the lasso tool
- Update other plots (heatmap, violin, etc.) with selected cells</p></li>
</ol>
<p><strong>Hierarchy:</strong>
All Cells → Global Filter → Lasso Selection → Subset in other plots</p>
<p><strong>Notes</strong>
- Global filter persists until changed
- Lasso selections reset when metadata/genes change
- If no lasso is applied, “Update Other Plots” passes all filtered cells</p>
</section>
<section id="export-selected-subgroup">
<h4>Export Selected Subgroup<a class="headerlink" href="#export-selected-subgroup" title="Link to this heading"></a></h4>
<a class="reference internal image-reference" href="_images/download.png"><img alt="_images/download.png" src="_images/download.png" style="width: 1000px;" />
</a>
<p>Selected cells can be exported in two formats:</p>
<ol class="arabic">
<li><p><strong>Cell IDs (.txt)</strong>
- Plain text list of selected cell identifiers
- Useful for downstream tools or sharing subsets</p></li>
<li><p><strong>Subset AnnData (.h5ad)</strong>
- Full AnnData object of selected cells
- Includes expression, metadata, embeddings, and metrics
- Useful for deeper analysis, re-clustering, or sharing complete</p>
<blockquote>
<div><p>subsets</p>
</div></blockquote>
</li>
</ol>
</section>
</section>
</section>
<section id="genome-track-visualization">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Genome Track Visualization</a><a class="headerlink" href="#genome-track-visualization" title="Link to this heading"></a></h2>
<section id="igv-browser-and-motif-dataset">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">IGV Browser and Motif Dataset</a><a class="headerlink" href="#igv-browser-and-motif-dataset" title="Link to this heading"></a></h3>
<a class="reference internal image-reference" href="_images/gb_motif.png"><img alt="_images/gb_motif.png" src="_images/gb_motif.png" style="width: 1000px;" />
</a>
<p>The IGV Browser tab integrates the <strong>Integrative Genomics Viewer (IGV)</strong>
for interactive exploration of genomic regions with multiple tracks
(e.g., gene annotations, ATAC-seq peaks, reference sequences). It also
includes a <strong>motif search tool</strong> for transcription factor binding
analysis using JASPAR IDs.</p>
<p><strong>Main Components</strong></p>
<ol class="arabic simple">
<li><p><strong>Session Selector</strong>: Choose from multiple predefined tracks separated by metadata</p></li>
<li><p><strong>Genome Browser</strong>: Navigate, zoom, and explore aligned tracks</p></li>
<li><p><strong>Motif Search</strong>: Enter JASPAR ID to view motif details and sequence logos</p></li>
</ol>
<p><strong>Use Cases</strong>
- Explore regulatory regions around genes of interest
- Compare accessibility across cell types
- Analyze transcription factor binding motifs</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="GUANACO User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deployment/index.html" class="btn btn-neutral float-right" title="Instruction for Using GUANACO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>